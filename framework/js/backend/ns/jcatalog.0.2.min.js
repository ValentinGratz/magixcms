/**
 * MAGIX CMS
 * @copyright  MAGIX CMS Copyright (c) 2011 - 2012 Gerits Aurelien, 
 * http://www.magix-cms.com, http://www.magix-cjquery.com
 * @license    Dual licensed under the MIT or GPL Version 3 licenses.
 * @version    0.2
 * @author Gérits Aurélien <aurelien@magix-cms.com>
 * @name ns_jcatalog
 *
 */
var ns_jcatalog_subcategory={_load_json_subcat:function(a){$.ajax({url:"/admin/catalog.php?upcat="+a+"&json_sub_cat=true",dataType:"json",type:"get",statusCode:{0:function(){console.error("jQuery Error")},401:function(){console.warn("access denied")},404:function(){console.warn("object not found")},403:function(){console.warn("request forbidden")},408:function(){console.warn("server timed out waiting for request")},500:function(){console.error("Internal Server Error")}},async:true,cache:false,beforeSend:function(){$("#list-sub-category").html('<img class="loader-block" src="/framework/img/square-circle.gif" />')},success:function(c){$("#list-sub-category").empty();var b='<ul id="sortsubcat">';b+="</ul>";$(b).appendTo("#list-sub-category");if(c===undefined){console.log(c)}if(c!==null){$.each(c,function(d,e){if($.ieTester()){return $('<li class="ui-state-default" id="sorder_'+e.idcls+'"><span class="arrowthick ui-icon ui-icon-arrowthick-2-n-s"></span>'+e.slibelle+'<div style="float:right;margin-top:-15px;top:0;margin-right:10px;"><a href="/admin/catalog.php?upsubcat='+e.idcls+'"><span class="lfloat ui-icon ui-icon-pencil"></span></a><a href="#" style="cursor:pointer;" class="aspanfloat dels" title="'+e.idcls+'"><span style="float:left;" class="ui-icon ui-icon-close"></span></a></div><div style="clear:both;"></div></li>').appendTo("#sortsubcat")}else{return $('<li class="ui-state-default" id="sorder_'+e.idcls+'"><span class="arrowthick ui-icon ui-icon-arrowthick-2-n-s"></span>'+e.slibelle+'<div style="float:right"><a href="/admin/catalog.php?upsubcat='+e.idcls+'"><span class="lfloat ui-icon ui-icon-pencil"></span></a><a href="#" class="aspanfloat dels" title="'+e.idcls+'"><span style="float:left;" class="ui-icon ui-icon-close"></span></a></li>').appendTo("#sortsubcat")}})}$("#sortsubcat li").hover(function(){$(this).addClass("ui-state-hover")},function(){$(this).removeClass("ui-state-hover")});$("#sortsubcat").sortable({placeholder:"ui-state-highlight",cursor:"move",axis:"y",update:function(){serial=$("#sortsubcat").sortable("serialize");$.ajax({url:"/admin/catalog.php?order",type:"post",cache:false,data:serial,error:function(){alert("theres an error with AJAX")}})}});$("#sortsubcat").disableSelection()}})},_loadImgSubCat:function(a){$.ajax({url:"/admin/catalog.php?upsubcat="+a+"&imgsubcat=1",dataType:"json",type:"get",statusCode:{0:function(){console.error("jQuery Error")},401:function(){console.warn("access denied")},404:function(){console.warn("object not found")},403:function(){console.warn("request forbidden")},408:function(){console.warn("server timed out waiting for request")},500:function(){console.error("Internal Server Error")}},async:true,cache:false,beforeSend:function(){$("#contener_image").html('<img src="/framework/img/square-circle.gif" />')},success:function(b){$("#contener_image").empty();if(b===undefined){console.log(b)}if(b!==null){$.each(b,function(c,d){return $('<img src="/upload/catalogimg/subcategory/'+d.img_s+'" />').appendTo("#contener_image")})}else{return $('<img src="/framework/img/no-picture.png" />').appendTo("#contener_image")}}})},_addNewSubCat:function(a){$("#forms-catalog-subcategory").submit(function(){$(this).ajaxSubmit({url:"/admin/catalog.php?category&post=1",type:"post",resetForm:true,beforeSubmit:function(){$("#list-sub-category").html('<img class="loader-block" src="/framework/img/square-circle.gif" />')},success:function(b){$.notice({ntype:"simple",time:2});$(".mc-head-request").html(b);ns_jcatalog_subcategory._load_json_subcat(a)}});return false})},_editSubCat:function(a){$("#forms-catalog-editsubcategory").submit(function(){var b="/admin/catalog.php?upsubcat="+a;$.notice({ntype:"ajaxsubmit",dom:this,uri:b+"&post=1",typesend:"post",delay:2800,time:2,reloadhtml:false,resetform:false});return false})},_editSubCatImg:function(a){$("#forms-catalog-editsubcategory-img").submit(function(){var b="/admin/catalog.php?upsubcat="+a;$(this).ajaxSubmit({url:b+"&postimg=1",type:"post",resetForm:true,beforeSubmit:function(){},success:function(c){$.notice({ntype:"simple",time:2});$(".mc-head-request").html(c);ns_jcatalog_subcategory._loadImgSubCat(a)}});return false})},_deleteSubCat:function(){$(".dels").live("click",function(b){b.preventDefault();var a=$(this).attr("title");$("#dialog").dialog({bgiframe:true,resizable:false,minHeight:180,modal:true,title:"Supprimé une sous catégorie ?",buttons:{"Delete item":function(){$(this).dialog("close");$.notice({ntype:"ajax",uri:"/admin/catalog.php?category&dels="+a,typesend:"get",delay:1800,time:1,reloadhtml:true})},Cancel:function(){$(this).dialog("close")}}})})},runEdit:function(){this._loadImgSubCat($("#usubcategory").val());this._editSubCat($("#usubcategory").val());this._editSubCatImg($("#usubcategory").val())}};var ns_jcatalog_category={_init:function(a){if(a!=false){$("#sortproduct li").hover(function(){$(this).addClass("ui-state-hover")},function(){$(this).removeClass("ui-state-hover")});$("#sortproduct").sortable({placeholder:"ui-state-highlight",dropOnEmpty:false,axis:"y",cursor:"move",update:function(){serial=$("#sortproduct").sortable("serialize");$.ajax({url:"/admin/catalog.php?catalog&order",type:"post",data:serial,error:function(){alert("theres an error with AJAX")}})}})}else{$("#sortcat li,#sortsubcat li").hover(function(){$(this).addClass("ui-state-hover")},function(){$(this).removeClass("ui-state-hover")})}},_load_json_cat:function(a){$.ajax({url:"/admin/catalog.php?getlang="+a+"&category=true&json_cat=true",dataType:"json",type:"get",statusCode:{0:function(){console.error("jQuery Error")},401:function(){console.warn("access denied")},404:function(){console.warn("object not found")},403:function(){console.warn("request forbidden")},408:function(){console.warn("server timed out waiting for request")},500:function(){console.error("Internal Server Error")}},async:true,cache:false,beforeSend:function(){$("#list-category").html('<img class="loader-block" src="/framework/img/square-circle.gif" />')},success:function(c){$("#list-category").empty();var b='<ul id="sortcat">';b+="</ul>";$(b).appendTo("#list-category");if(c===undefined){console.log(c)}if(c!==null){$.each(c,function(d,e){if(e.iso!=null){langspan='<span class="lfloat">'+e.iso+"</span>"}else{langspan='<span class="lfloat ui-icon ui-icon-flag"></span>'}if($.ieTester()){return $('<li class="ui-state-default" id="corder_'+e.idclc+'"><span class="arrowthick ui-icon ui-icon-arrowthick-2-n-s"></span>'+e.clibelle+'<div style="float:right;margin-top:-15px;top:0;margin-right:10px;">'+langspan+'<a href="/admin/catalog.php?upcat='+e.idclc+'"><span class="lfloat ui-icon ui-icon-pencil"></span></a><a href="#" class="aspanfloat delc" title="'+e.idclc+'"><span style="float:left;" class="ui-icon ui-icon-close"></span></a></div><div style="clear:both;"></div></li>').appendTo("#sortcat")}else{return $('<li class="ui-state-default" id="corder_'+e.idclc+'"><span class="arrowthick ui-icon ui-icon-arrowthick-2-n-s"></span>'+e.clibelle+'<div style="float:right;">'+langspan+'<a href="/admin/catalog.php?upcat='+e.idclc+'"><span class="lfloat ui-icon ui-icon-pencil"></span></a><a href="#" class="aspanfloat delc" title="'+e.idclc+'"><span style="float:left;" class="ui-icon ui-icon-close"></span></a></div></li>').appendTo("#sortcat")}})}$("#sortcat li").hover(function(){$(this).addClass("ui-state-hover")},function(){$(this).removeClass("ui-state-hover")});$("#sortcat").sortable({placeholder:"ui-state-highlight",cursor:"move",axis:"y",update:function(){serial=$("#sortcat").sortable("serialize");$.ajax({url:"/admin/catalog.php?order",type:"post",cache:false,data:serial,error:function(){alert("theres an error with AJAX")}})}});$("#sortcat").disableSelection()}})},_addNewCat:function(b,a){$("#forms-catalog-category").submit(function(){$(this).ajaxSubmit({url:"/admin/catalog.php?category&post=1",type:"post",resetForm:true,beforeSubmit:function(){$("#list-category").html('<img class="loader-block" src="/framework/img/square-circle.gif" />')},success:function(c){$("#img_c:file").val("");$.notice({ntype:"simple",time:2});$(".mc-head-request").html(c);if(b==true){ns_jcatalog_category._load_json_cat(a)}else{ns_jcatalog_product._google_chart_language()}}});return false})},_loadImgCat:function(a){$.ajax({url:"/admin/catalog.php?upcat="+a+"&imgcat=1",dataType:"json",type:"get",statusCode:{0:function(){console.error("jQuery Error")},401:function(){console.warn("access denied")},404:function(){console.warn("object not found")},403:function(){console.warn("request forbidden")},408:function(){console.warn("server timed out waiting for request")},500:function(){console.error("Internal Server Error")}},async:true,cache:false,beforeSend:function(){$("#contener_image").html('<img src="/framework/img/square-circle.gif" />')},success:function(b){$("#contener_image").empty();if(b===undefined){console.log(b)}if(b!==null){$.each(b,function(c,d){return $('<img src="/upload/catalogimg/category/'+d.img_c+'" />').appendTo("#contener_image")})}else{return $('<img src="/framework/img/no-picture.png" />').appendTo("#contener_image")}}})},_editCat:function(a){$("#forms-catalog-editcategory").submit(function(){var b="/admin/catalog.php?upcat="+a;$.notice({ntype:"ajaxsubmit",dom:this,uri:b+"&post=1",typesend:"post",delay:2800,time:2,reloadhtml:false,resetform:false});return false})},_editCatImg:function(a){$("#forms-catalog-editcategory-img").submit(function(){var b="/admin/catalog.php?upcat="+a;$(this).ajaxSubmit({url:b+"&postimg=1",type:"post",resetForm:true,beforeSubmit:function(){$("#contener_image").html('<img src="/framework/img/square-circle.gif" />')},success:function(c){$.notice({ntype:"simple",time:2});$(".mc-head-request").html(c);ns_jcatalog_category._loadImgCat(a)}});return false})},_deleteCat:function(){$(".delc").live("click",function(b){b.preventDefault();var a=$(this).attr("title");$("#dialog").dialog({bgiframe:true,resizable:false,height:220,modal:true,title:"Supprimé cette catégorie",overlay:{backgroundColor:"#000",opacity:0.5},open:function(){$("p").append("<br />Les sous catégorie seront également supprimé")},buttons:{"Delete item":function(){$(this).dialog("close");$.notice({ntype:"ajax",uri:"/admin/catalog.php?category&delc="+a,typesend:"get",delay:1800,time:1,reloadhtml:true})},Cancel:function(){$(this).dialog("close")}}})})},run:function(){this._addNewCat(false,false);ns_jcatalog_product._google_chart_language()},runLang:function(){this._init(false);this._load_json_cat($("#idlang").val());this._addNewCat(true,$("#idlang").val());this._deleteCat()},runEdit:function(){this._init(true);this._loadImgCat($("#ucategory").val());ns_jcatalog_subcategory._load_json_subcat($("#ucategory").val());ns_jcatalog_subcategory._addNewSubCat($("#ucategory").val());this._editCat($("#ucategory").val());this._editCatImg($("#ucategory").val());ns_jcatalog_subcategory._deleteSubCat()}};var ns_jcatalog_product={_load_json_cat_product:function(a){$.ajax({url:"/admin/catalog.php?product&editproduct="+a+"&json_cat_product=true",dataType:"json",type:"get",statusCode:{0:function(){console.error("jQuery Error")},401:function(){console.warn("access denied")},404:function(){console.warn("object not found")},403:function(){console.warn("request forbidden")},408:function(){console.warn("server timed out waiting for request")},500:function(){console.error("Internal Server Error")}},async:true,cache:false,beforeSend:function(){$("#load_cat_product").html('<img class="loader-block" src="/framework/img/square-circle.gif" />')},success:function(b){$("#load_cat_product").empty();var c='<table id="table_cat_product" class="table-widget-product"><thead><tr style="padding:3px;" class="ui-widget ui-widget-header"><th>ID</th><th><span class="lfloat ui-icon ui-icon-folder-open"></span>catégorie</th><th><span class="lfloat ui-icon ui-icon-folder-collapsed"></span> sous catégorie</th><th><span class="lfloat ui-icon ui-icon-close"></span></th></tr></thead><tbody>';c+="</tbody></table>";$(c).appendTo("#load_cat_product");if(b===undefined){console.log(b)}if(b!==null){$.each(b,function(d,e){if(e.slibelle!=null){subcat=e.slibelle}else{subcat='<span class="lfloat ui-icon ui-icon-minus"></span>'}return $("<tr><td>"+e.idproduct+'</td><td class="medium-cell">'+e.clibelle+"</td><td>"+subcat+'</td><td class="small-icon"><a href="#" class="d-in-product" title="'+e.idproduct+'"><span style="float:left;" class="ui-icon ui-icon-close"></span></td></tr>').appendTo("#table_cat_product tbody")})}else{return $('<tr><td><span class="lfloat ui-icon ui-icon-minus"></span></td><td><span class="lfloat ui-icon ui-icon-minus"></span></td><td><span class="lfloat ui-icon ui-icon-minus"></span></td><td><span class="lfloat ui-icon ui-icon-minus"></span></td></tr>').appendTo("#table_cat_product tbody")}}})},_deleteCatProduct:function(a){$(".d-in-product").live("click",function(c){c.preventDefault();var b=$(this).attr("title");$("#dialog").dialog({bgiframe:true,resizable:false,height:180,modal:true,title:"Supprimé ce produit ?",buttons:{"Delete item":function(){$(this).dialog("close");$.ajax({url:"/admin/catalog.php?product&editproduct="+a+"&d_in_product="+b,type:"get",statusCode:{0:function(){console.error("jQuery Error")},401:function(){console.warn("access denied")},404:function(){console.warn("object not found")},403:function(){console.warn("request forbidden")},408:function(){console.warn("server timed out waiting for request")},500:function(){console.error("Internal Server Error")}},async:true,cache:false,beforeSend:function(){},success:function(d){$.notice({ntype:"simple",time:2});$(".mc-head-request").html(d);ns_jcatalog_product._load_json_cat_product(a)}})},Cancel:function(){$(this).dialog("close")}}})})},_load_rel_product:function(a){$.ajax({url:"/admin/catalog.php?product&editproduct="+a+"&json_rel_product=true",dataType:"json",type:"get",statusCode:{0:function(){console.error("jQuery Error")},401:function(){console.warn("access denied")},404:function(){console.warn("object not found")},403:function(){console.warn("request forbidden")},408:function(){console.warn("server timed out waiting for request")},500:function(){console.error("Internal Server Error")}},async:true,cache:false,beforeSend:function(){$("#load_rel_product").html('<img class="loader-block" src="/framework/img/square-circle.gif" />')},success:function(b){$("#load_rel_product").empty();var c='<table id="table_rel_product" class="table-widget-product"><thead><tr style="padding:3px;" class="ui-widget ui-widget-header"><th>ID</th><th><span class="lfloat ui-icon ui-icon-folder-open"></span>catégorie</th><th><span class="lfloat ui-icon ui-icon-folder-collapsed"></span> sous catégorie</th><th><span class="lfloat magix-icon magix-icon-h1"></span> Titre</th><th><span class="lfloat ui-icon ui-icon-close"></span></th></tr></thead><tbody>';c+="</tbody></table>";$(c).appendTo("#load_rel_product");if(b===undefined){console.log(b)}if(b!==null){$.each(b,function(d,e){if(e.slibelle!=null){subcat=e.slibelle}else{subcat='<span class="lfloat ui-icon ui-icon-minus"></span>'}return $("<tr><td>"+e.idrelproduct+'</td><td class="medium-cell">'+e.clibelle+'</td><td class="medium-cell">'+subcat+'</td><td class="medium-cell">'+e.titlecatalog+'</td><td class="small-icon"><a href="#" class="d-rel-product" title="'+e.idrelproduct+'"><span style="float:left;" class="ui-icon ui-icon-close"></span></td></tr>').appendTo("#table_rel_product tbody")})}else{return $('<tr><td><span class="lfloat ui-icon ui-icon-minus"></span></td><td class="medium-cell"><span class="lfloat ui-icon ui-icon-minus"></span></td><td class="medium-cell"><span class="lfloat ui-icon ui-icon-minus"></span></td><td class="medium-cell"><span class="lfloat ui-icon ui-icon-minus"></span></td><td><span class="lfloat ui-icon ui-icon-minus"></span></td></tr>').appendTo("#table_rel_product tbody")}}})},_deleteRelProduct:function(a){$(".d-rel-product").live("click",function(c){c.preventDefault();var b=$(this).attr("title");$("#dialog").dialog({bgiframe:true,resizable:false,height:180,modal:true,title:"Supprimé une liaison avec ce produit ?",buttons:{"Delete item":function(){$(this).dialog("close");$.ajax({url:"/admin/catalog.php?product&editproduct="+a+"&d_rel_product="+b,type:"get",statusCode:{0:function(){console.error("jQuery Error")},401:function(){console.warn("access denied")},404:function(){console.warn("object not found")},403:function(){console.warn("request forbidden")},408:function(){console.warn("server timed out waiting for request")},500:function(){console.error("Internal Server Error")}},async:true,cache:false,beforeSend:function(){},success:function(d){$.notice({ntype:"simple",time:2});$(".mc-head-request").html(d);ns_jcatalog_product._load_rel_product(a)}})},Cancel:function(){$(this).dialog("close")}}})})},_loadImgProduct:function(a){$.ajax({url:"/admin/catalog.php?product&getimg="+a+"&jsonimgproduct=1",dataType:"json",type:"get",statusCode:{0:function(){console.error("jQuery Error")},401:function(){console.warn("access denied")},404:function(){console.warn("object not found")},403:function(){console.warn("request forbidden")},408:function(){console.warn("server timed out waiting for request")},500:function(){console.error("Internal Server Error")}},async:true,cache:false,beforeSend:function(){$("#contener_image_product,#contener_image_medium,#contener_image_mini").html('<img src="/framework/img/square-circle.gif" />')},success:function(c){$("#contener_image_product,#contener_image_medium,#contener_image_mini,#gwidth,#gheight,#pwidth,#pheight,#swidth,#sheight").empty();if(c===undefined){console.log(c)}if(c!==null){$.each(c,function(e,f){var d=$('<img src="/upload/catalogimg/product/'+f.imgcatalog+'" width="'+f.gwidth+'" height="'+f.gheight+'" />').appendTo("#contener_image_product");d+=$('<img src="/upload/catalogimg/medium/'+f.imgcatalog+'" width="'+f.pwidth+'" height="'+f.pheight+'" />').appendTo("#contener_image_medium");d+=$('<img src="/upload/catalogimg/mini/'+f.imgcatalog+'" width="'+f.swidth+'" height="'+f.sheight+'" />').appendTo("#contener_image_mini");d+=$("<strong>"+f.gwidth+"</strong>").appendTo("#gwidth");d+=$("<strong>"+f.gheight+"</strong>").appendTo("#gheight");d+=$("<strong>"+f.pwidth+"</strong>").appendTo("#pwidth");d+=$("<strong>"+f.pheight+"</strong>").appendTo("#pheight");d+=$("<strong>"+f.swidth+"</strong>").appendTo("#swidth");d+=$("<strong>"+f.sheight+"</strong>").appendTo("#sheight");return d})}else{var b=$('<img src="/framework/img/no-picture.png" width="120" height="120" />').appendTo("#contener_image_product");b+=$('<img src="/framework/img/no-picture.png" width="120" height="120" />').appendTo("#contener_image_medium");b+=$('<img src="/framework/img/no-picture.png" width="120" height="120" />').appendTo("#contener_image_mini");b+=$("<strong>0</strong>").appendTo("#gwidth");b+=$("<strong>0</strong>").appendTo("#gheight");b+=$("<strong>0</strong>").appendTo("#pwidth");b+=$("<strong>0</strong>").appendTo("#pheight");b+=$("<strong>0</strong>").appendTo("#swidth");b+=$("<strong>0</strong>").appendTo("#sheight");return b}}})},_loadImgMicroGalery:function(a){$.ajax({url:"/admin/catalog.php?product&getimg="+a+"&json_micro_galery=1",dataType:"json",type:"get",statusCode:{0:function(){console.error("jQuery Error")},401:function(){console.warn("access denied")},404:function(){console.warn("object not found")},403:function(){console.warn("request forbidden")},408:function(){console.warn("server timed out waiting for request")},500:function(){console.error("Internal Server Error")}},async:true,cache:false,beforeSend:function(){$("#contener_micro_galery").html('<img class="loader-block" src="/framework/img/square-circle.gif" />')},success:function(b){$("#contener_micro_galery").empty();var c='<div id="list-image-galery">';c+="</div>";$(c).appendTo("#contener_micro_galery");if(b===undefined){console.log(b)}if(b!==null){var d="";$.each(b,function(e,f){d+=$('<div class="list-img ui-widget-content"><div class="title-galery-image ui-widget-content"><a href="#" class="delmicro" title="'+f.idmicro+'"><span style="float:right;" class="ui-icon ui-icon-trash"></span></a></div><div class="img-galery"><img src="/upload/catalogimg/galery/mini/'+f.imgcatalog+'" /></div></div>').appendTo("#list-image-galery")});d+=$('<div style="clear:left;"></div>').appendTo("#list-image-galery");$(".title-galery-image .delmicro").hover(function(){$(this).parent().addClass("ui-state-active")},function(){$(this).parent().removeClass("ui-state-active")});return d}}})},_editImgProduct:function(b){var a=$("#forms-catalog-image").validate({rules:{imgcatalog:{required:true,minlength:1,accept:"(jpe?g|gif|png|JPE?G|GIF|PNG)"}},submitHandler:function(c){$(c).ajaxSubmit({url:"/admin/catalog.php?product&getimg="+b+"&postimgproduct=1",type:"post",resetForm:true,beforeSubmit:function(){$("#contener_image_product,#contener_image_medium,#contener_image_mini").html('<img src="/framework/img/square-circle.gif" />')},success:function(d){$("#imgcatalog:file").val("");ns_jcatalog_product._loadImgProduct(b)}});return false}});$("#forms-catalog-image").valphoto},_addImgMicroGalery:function(b){var a=$("#forms-catalog-galery").validate({rules:{imggalery:{required:true,minlength:1,accept:"(jpe?g|gif|png|JPE?G|GIF|PNG)"}},submitHandler:function(c){$(c).ajaxSubmit({url:"/admin/catalog.php?product&getimg="+b+"&postimggalery=1",type:"post",beforeSubmit:function(){$("#contener_micro_galery").html('<img class="loader-block" src="/framework/img/square-circle.gif" />')},success:function(d){$("#imggalery:file").val("");ns_jcatalog_product._loadImgMicroGalery(b)}})}});$("#forms-catalog-galery").valgalery},_deleteMicroGalery:function(a){$(".delmicro").live("click",function(c){c.preventDefault();var b=$(this).attr("title");$("#dialog").dialog({bgiframe:true,resizable:false,height:180,modal:true,title:"Supprimé cette image de la galerie",buttons:{"Delete item":function(){$(this).dialog("close");$.ajax({type:"get",statusCode:{0:function(){console.error("jQuery Error")},401:function(){console.warn("access denied")},404:function(){console.warn("object not found")},403:function(){console.warn("request forbidden")},408:function(){console.warn("server timed out waiting for request")},500:function(){console.error("Internal Server Error")}},url:"/admin/catalog.php?product&getimg="+a+"&delmicro="+b,async:false,success:function(d){$.notice({ntype:"simple",time:2});$(".mc-head-request").html(d);ns_jcatalog_product._loadImgMicroGalery(a)}})},Cancel:function(){$(this).dialog("close")}}})})},_deleteProduct:function(){$(".deleteproduct").live("click",function(b){b.preventDefault();var a=$(this).attr("title");$("#dialog").dialog({bgiframe:true,resizable:false,minHeight:180,modal:true,title:"Supprimé ce produit",buttons:{"Delete item":function(){$(this).dialog("close");$.notice({ntype:"ajax",uri:"/admin/catalog.php?product&delproduct="+a,typesend:"get",delay:1800,time:1,reloadhtml:true})},Cancel:function(){$(this).dialog("close")}}})})},_addCatalogCardProduct:function(){$("#forms-catalog-card-product").submit(function(){$(this).ajaxSubmit({url:"/admin/catalog.php?product=true&add_card_product=1",type:"post",resetForm:true,success:function(a){$.notice({ntype:"simple",time:2});$(".mc-head-request").html(a)}});return false})},_editCatalogCardProduct:function(a){$("#forms-catalog-card-product-edit").submit(function(){if(a!=null){$.notice({ntype:"ajaxsubmit",delay:1800,dom:this,uri:"/admin/catalog.php?product&editproduct="+a+"&updateproduct=1",typesend:"post",noticedata:null,resetform:false,time:2,reloadhtml:false});return false}else{console.log("%s: %o","productid is null",a)}})},_addProduct:function(a){$("#forms-catalog-product").submit(function(){if(a!=null){$(this).ajaxSubmit({url:"/admin/catalog.php?product=true&editproduct="+a+"&add_product=1",type:"post",resetForm:false,success:function(b){$.notice({ntype:"simple",time:2});$(".mc-head-request").html(b);ns_jcatalog_product._load_json_cat_product(a)}});return false}else{console.log("%s: %o","productid is null",a)}})},_addRelProduct:function(a){$("#forms-catalog-rel-product").submit(function(){if(a!=null){$(this).ajaxSubmit({url:"/admin/catalog.php?product=true&editproduct="+a+"&post_rel_product=1",type:"post",resetForm:false,success:function(b){$.notice({ntype:"simple",time:2});$(".mc-head-request").html(b);ns_jcatalog_product._load_rel_product(a)}});return false}else{console.log("%s: %o","productid is null",a)}})},_search_product:function(){$("#forms-search-catalog").submit(function(){$(this).ajaxSubmit({url:"/admin/catalog.php?get_search_page=true",type:"post",dataType:"json",resetForm:true,beforeSubmit:function(){$("#result-search-page").html('<img class="loader-block" src="/framework/img/square-circle.gif" />')},success:function(a){$("#result-search-page").empty();var b='<table id="table_search_product" class="table-widget-product"><thead><tr style="padding:3px;" class="ui-widget ui-widget-header"><th>ID</th><th><span class="lfloat magix-icon magix-icon-h1"></span>Titre</th><th><span class="lfloat ui-icon ui-icon-image"></span></th><th><span class="lfloat ui-icon ui-icon-flag"></span></th><th><span class="lfloat ui-icon ui-icon-person"></span></th><th><span class="lfloat ui-icon ui-icon-transfer-e-w"></span></th><th><span class="lfloat ui-icon ui-icon-copy"></span></th><th><span class="lfloat ui-icon ui-icon-pencil"></span></th><th><span class="lfloat ui-icon ui-icon-close"></span></th></tr></thead><tbody>';b+="</tbody></table>";$(b).appendTo("#result-search-page");if(a===undefined){console.log(a)}if(a!==null){$.each(a,function(c,d){if(d.imgcatalog!=null){imgcatalog='<div class="ui-state-highlight" style="border:none;"><a href="/admin/catalog.php?product&getimg='+d.idcatalog+'"><span style="float:left" class="ui-icon ui-icon-check"></span></a></div>'}else{imgcatalog='<div class="ui-state-error" style="border:none;"><a href="/admin/catalog.php?product&getimg='+d.idcatalog+'"><span style="float:left" class="ui-icon ui-icon-cancel"></span></a></div>'}if(d.iso!=null){flaglang=d.iso}return $("<tr><td>"+d.idcatalog+'</td><td class="medium-cell"><a href="/admin/catalog.php?product&editproduct='+d.idcatalog+'" class="linkurl">'+d.titlecatalog+'</a></td><td class="small-icon">'+imgcatalog+'</td><td class="small-icon">'+flaglang+'</td><td class="small-icon">'+d.pseudo+'</td><td class="small-icon"><a href="/admin/catalog.php?product&moveproduct='+d.idcatalog+'" class="linkurl"><span class="lfloat ui-icon ui-icon-transfer-e-w"></span></a></td><td class="small-icon"><a href="/admin/catalog.php?product&copyproduct='+d.idcatalog+'" class="linkurl"><span class="lfloat ui-icon ui-icon-copy"></span></a></td><td class="small-icon"><a href="/admin/catalog.php?product&editproduct='+d.idcatalog+'" class="linkurl"><span class="lfloat ui-icon ui-icon-pencil"></span></a></td><td class="small-icon"><a href="#" class="deleteproduct" title="'+d.idcatalog+'"><span style="float:left;" class="ui-icon ui-icon-close"></span></a></td></tr>').appendTo("#table_search_product tbody")})}else{return $('<tr><td><span class="lfloat ui-icon ui-icon-minus"></span></td><td class="medium-cell"><span class="lfloat ui-icon ui-icon-minus"></span></td><td class="small-icon"><span class="lfloat ui-icon ui-icon-minus"></span></td><td class="small-icon"><span class="lfloat ui-icon ui-icon-minus"></span></td><td class="small-icon"><span class="lfloat ui-icon ui-icon-minus"></span></td><td class="small-icon"><span class="lfloat ui-icon ui-icon-minus"></span></td><td class="small-icon"><span class="lfloat ui-icon ui-icon-minus"></span></td><td class="small-icon"><span class="lfloat ui-icon ui-icon-minus"></span></td><td class="small-icon"><span class="lfloat ui-icon ui-icon-minus"></span></td></tr>').appendTo("#table_search_product tbody")}}});return false})},_copyProduct:function(b){var a=$("#copy-catalog-product").validate({onsubmit:true,event:"submit",rules:{titlecatalog:{required:true,minlength:2},desccatalog:{required:true}},messages:{titlecatalog:{required:"Enter a title"},desccatalog:{required:"Enter a content"}},submitHandler:function(c){$.notice({ntype:"ajaxsubmit",dom:c,uri:"/admin/catalog.php?product&copyproduct="+b+"&postcopyproduct",typesend:"post",delay:1800,time:1,reloadhtml:false})}});$("#copy-catalog-product").formsproduct},_moveProduct:function(b){var a=$("#move-catalog-product").validate({onsubmit:true,event:"submit",rules:{idclc:{required:true}},messages:{idclc:{required:"select category"}},submitHandler:function(c){$.notice({ntype:"ajaxsubmit",dom:c,uri:"/admin/catalog.php?product&moveproduct="+b+"&postmoveproduct",typesend:"post",delay:1800,time:1,reloadhtml:false})}});$("#move-catalog-product").formsproduct},_google_chart_language:function(){$.ajax({url:"/admin/catalog.php?json_google_chart_catalog=true",dataType:"json",type:"get",statusCode:{0:function(){console.error("jQuery Error")},401:function(){console.warn("access denied")},404:function(){console.warn("object not found")},403:function(){console.warn("request forbidden")},408:function(){console.warn("server timed out waiting for request")},500:function(){console.error("Internal Server Error")}},async:true,cache:false,beforeSend:function(){$("#chart-google-catalog").html('<img class="loader-block" src="/framework/img/square-circle.gif" />')},success:function(a){$("#chart-google-catalog").empty();var b={title:"Catalog Statistics",series:[{label:"Produits"},{label:"Catégories"},{label:"Sous catégories"}],legend:{show:true,location:"ne",placement:"outsideGrid"},seriesColors:["#4bb2c5","#EAA228","#c5b47f","#579575","#839557","#958c12","#953579","#4b5de4","#d8b83f","#ff5800","#0085cc"],seriesDefaults:{min:1,shadow:true,renderer:$.jqplot.BarRenderer,rendererOptions:{barPadding:8,barMargin:10,fillToZero:true,barWidth:25}},axesDefaults:{tickOptions:{fontFamily:"Georgia",fontSize:"10pt"}},axes:{xaxis:{renderer:$.jqplot.CategoryAxisRenderer,ticks:a.lang},yaxis:{}}};$.jqplot("chart-google-catalog",[a.catalog_count,a.catalog_category_count,a.catalog_subcategory_count],b)}})},run:function(){this._deleteProduct();this._search_product();this._google_chart_language()},runAdd:function(){this._addCatalogCardProduct()},runEdit:function(){this._load_json_cat_product($("#idcatalog").val());this._deleteCatProduct($("#idcatalog").val());this._load_rel_product($("#idcatalog").val());this._deleteRelProduct($("#idcatalog").val());this._editCatalogCardProduct($("#idcatalog").val());this._addProduct($("#idcatalog").val());this._addRelProduct($("#idcatalog").val())},runImgEdit:function(){this._loadImgProduct($("#idproduct").val());this._loadImgMicroGalery($("#idproduct").val());this._editImgProduct($("#idproduct").val());this._addImgMicroGalery($("#idproduct").val());this._deleteMicroGalery($("#idproduct").val())},runCopy:function(){this._copyProduct($("#idproduct").val())},runMove:function(){this._moveProduct($("#idproduct").val())}};