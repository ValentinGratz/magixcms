/**
 * MAGIX CMS
 * @copyright  MAGIX CMS Copyright (c) 2011 - 2012 Gerits Aurelien, 
 * http://www.magix-cms.com, http://www.magix-cjquery.com
 * @license    Dual licensed under the MIT or GPL Version 3 licenses.
 * @version    0.2
 * @author Gérits Aurélien <aurelien@magix-cms.com>
 * @name ns_jlanguage
 *
 */
var ns_jlanguage={_listLang:function(){$.nicenotify({ntype:"ajax",uri:"/admin/lang.php?json_list_lang=true",typesend:"get",datatype:"json",beforeParams:function(){$("#list_lang").html('<img class="loader-block" src="/framework/img/square-circle.gif" />')},successParams:function(a){$("#list_lang").empty();$.nicenotify.initbox(a,{display:false});if(a===undefined){console.log(a)}if(a!==null){var b='<table id="table-language" class="table-widget-product"><thead><tr style="padding:3px;" class="ui-widget ui-widget-header"><th>ID</th><th><span class="lfloat magix-icon magix-icon-locale"></span></th><th>Langue</th><th><span class="lfloat ui-icon ui-icon-flag"></span></th><th>Defaut</th><th>Active</th><th><span class="lfloat ui-icon ui-icon-pencil"></span></th><th><span class="lfloat ui-icon ui-icon-close"></span></th></tr></thead><tbody>';b+="</tbody></table>";$(b).appendTo("#list_lang");$.each(a,function(c,d){if(d.active_lang!=0){active='<a href="#" class="u_active_lang" rel="'+d.idlang+'"><span class="lfloat magix-icon magix-icon-network-status-busy"></span></a>'}else{active='<a href="#" class="u_active_lang" rel="'+d.idlang+'"><span class="lfloat magix-icon magix-icon-network-status"></span></a>'}if(d.default_lang!=0){defaultlang='<span class="lfloat magix-icon magix-icon-check"></span>'}else{defaultlang='<span class="lfloat magix-icon magix-icon-cross"></span>'}return $("<tr><td>"+d.idlang+"</td><td>"+d.iso+"</td><td>"+d.language+'</td><td class="small-icon"><img src="/upload/iso_lang/'+d.iso+'.png" width="16" height="11" alt="'+d.iso+'" /></td><td class="small-icon">'+defaultlang+'</td><td class="small-icon">'+active+'</td><td class="small-icon"><a href="/admin/lang.php?edit='+d.idlang+'"><span style="float:left;" class="ui-icon ui-icon-pencil"></span></a></td><td class="small-icon"><a href="#" class="del-lang" rel="'+d.idlang+'"><span style="float:left;" class="ui-icon ui-icon-close"></span></a></td></tr>').appendTo("#table-language tbody")})}else{return $('<tr><td><span class="lfloat ui-icon ui-icon-minus"></span></td><td><span class="lfloat ui-icon ui-icon-minus"></span></td><td><span class="lfloat ui-icon ui-icon-minus"></span></td><td><span class="lfloat ui-icon ui-icon-minus"></span></td><td><span class="lfloat ui-icon ui-icon-minus"></span></td><td><span class="lfloat ui-icon ui-icon-minus"></span></td><td><span class="lfloat ui-icon ui-icon-minus"></span></td><td><span class="lfloat ui-icon ui-icon-minus"></span></td></tr>').appendTo("#table-language tbody")}}})},_addNewLanguage:function(){$("#forms-add-lang").on("submit",function(){$.nicenotify({ntype:"submit",uri:"/admin/lang.php",typesend:"post",idforms:$(this),resetform:true,successParams:function(a){$.nicenotify.initbox(a);ns_jlanguage._listLang()}});return false})},_editNewLanguage:function(a){$("#forms-update-lang").on("submit",function(){$.nicenotify({ntype:"submit",uri:"/admin/lang.php?edit="+a,typesend:"post",idforms:$(this),resetform:false,successParams:function(b){$.nicenotify.initbox(b);ns_jlanguage._listLang()}});return false})},_deleteLang:function(){$(document).on("click",".del-lang",function(b){b.preventDefault();var a=$(this).attr("rel");$("#dialog_delete").dialog({bgiframe:true,resizable:false,height:140,modal:true,buttons:{Delete:function(){$(this).dialog("close");$.nicenotify({ntype:"ajax",uri:"/admin/lang.php",typesend:"post",noticedata:"dellang="+a,successParams:function(c){$.nicenotify.initbox(c);ns_jlanguage._listLang()}})},Cancel:function(){$(this).dialog("close")}}})})},_google_chart_language:function(){$.nicenotify({ntype:"ajax",uri:"/admin/lang.php?json_google_chart_lang=true",typesend:"get",datatype:"json",beforeParams:function(){$("#chart-google-language").html('<img class="loader-block" src="/framework/img/square-circle.gif" />')},successParams:function(a){$("#chart-google-language").empty();$.nicenotify.initbox(a,{display:false});var b={title:"Language statistics",series:[{label:"CMS"},{label:"NEWS"},{label:"PRODUCT"}],legend:{show:true,location:"ne",placement:"outsideGrid"},seriesColors:["#4bb2c5","#EAA228","#c5b47f","#579575","#839557","#958c12","#953579","#4b5de4","#d8b83f","#ff5800","#0085cc"],seriesDefaults:{min:1,shadow:true,renderer:$.jqplot.BarRenderer,rendererOptions:{barDirection:"vertical",barPadding:8,barMargin:10,fillToZero:true,barWidth:25}},axesDefaults:{tickOptions:{fontFamily:"Georgia",fontSize:"10pt"}},axes:{xaxis:{renderer:$.jqplot.CategoryAxisRenderer,ticks:a.lang},yaxis:{}}};$.jqplot("chart-google-language",[a.cms_pages_count,a.news_count,a.product_count],b)}})},_activeLang:function(){$(document).on("click",".u_active_lang",function(b){b.preventDefault();var a=$(this).attr("rel");$("#confirm_published").dialog({resizable:false,height:140,width:320,modal:true,buttons:{Activer:function(){$(this).dialog("close");$.nicenotify({ntype:"ajax",uri:"/admin/lang.php",typesend:"post",noticedata:"idlang="+a+"&active_lang=1",successParams:function(c){$.nicenotify.initbox(c,{display:false});ns_jlanguage._listLang()}});return false},"Désactiver":function(){$(this).dialog("close");$.nicenotify({ntype:"ajax",uri:"/admin/lang.php",typesend:"post",noticedata:"idlang="+a+"&active_lang=0",successParams:function(c){$.nicenotify.initbox(c,{display:false});ns_jlanguage._listLang()}});return false},Cancel:function(){$(this).dialog("close")}}})})},run:function(){this._listLang();this._google_chart_language();this._addNewLanguage();this._deleteLang();this._activeLang()},runEdit:function(){this._listLang();this._google_chart_language();this._editNewLanguage($("#idlang").val());this._activeLang()}};