/**
 * MAGIX CMS
 * @copyright  MAGIX CMS Copyright (c) 2011 - 2012 Gerits Aurelien, 
 * http://www.magix-cms.com, http://www.magix-cjquery.com
 * @license    Dual licensed under the MIT or GPL Version 3 licenses.
 * @version    0.2
 * @author Gérits Aurélien <aurelien@magix-cms.com>
 * @name ns_jrewritemetas
 *
 */
var ns_jrewritemetas={_loadingConfig:function(){$.getScript("/framework/js/tools/jquery.a-tools-1.5.2.min.js",function(){$("#add-category").bind("click",function(){var a=$("#strrewrite").val();$("#strrewrite").insertAtCaretPos("[[category]]");return false});$("#add-subcategory").bind("click",function(){var a=$("#strrewrite").val();$("#strrewrite").insertAtCaretPos("[[subcategory]]");return false});$("#add-product").bind("click",function(){var a=$("#strrewrite").val();$("#strrewrite").insertAtCaretPos("[[record]]");return false})})},_listingRecords:function(){$.ajax({url:"/admin/rewritemetas.php?load_metas=true",dataType:"json",type:"get",statusCode:{0:function(){console.error("jQuery Error")},401:function(){console.warn("access denied")},404:function(){console.warn("object not found")},403:function(){console.warn("request forbidden")},408:function(){console.warn("server timed out waiting for request")},500:function(){console.error("Internal Server Error")}},async:true,cache:false,beforeSend:function(){$("#load_list_metas").html('<img class="loader-block" src="/framework/img/square-circle.gif" />')},success:function(a){$("#load_list_metas").empty();var b='<table id="table_load_metas" class="table-widget-product"><thead><tr style="padding:3px;" class="ui-widget ui-widget-header"><th>ID</th><th class="medium-cell">Métas</th><th class="medium-cell">Module</th><th class="medium-cell">Phrase</th><th class="small-icon">Level</th><th class="small-icon"><span style="float:left;" class="ui-icon ui-icon-flag"></span></th><th class="small-icon"><span style="float:left;" class="ui-icon ui-icon-pencil"></span></th><th class="small-icon"><span class="lfloat ui-icon ui-icon-close"></span></th></tr></thead><tbody>';b+="</tbody></table>";$(b).appendTo("#load_list_metas");if(a===undefined){console.log(a)}if(a!==null){$.each(a,function(c,e){if(e.iso!=null){flaglang=e.iso}else{flaglang='<div class="ui-state-error" style="border:none;"><span style="float:left;" class="ui-icon ui-icon-cancel"></span></div>'}switch(e.idmetas){case"1":var d="TITLE";break;case"2":var d="DESCRIPTION";break}return $("<tr><td>"+e.idrewrite+'</td><td class="medium-cell">'+d+'</td><td class="medium-cell">'+e.attribute+'</td><td class="medium-cell">'+e.strrewrite+'</td><td class="small-icon">'+e.level+'</td><td class="small-icon">'+flaglang+'</td><td class="small-icon"><a href="/admin/rewritemetas.php?edit='+e.idrewrite+'" class="linkurl"><span class="lfloat ui-icon ui-icon-pencil"></span></a></td><td class="small-icon"><a href="#" class="d-config-rmetas" title="'+e.idrewrite+'"><span style="float:left;" class="ui-icon ui-icon-close"></span></a></td></tr>').appendTo("#load_list_metas tbody")})}else{return $('<tr><td><span class="lfloat ui-icon ui-icon-minus"></span></td><td><span class="lfloat ui-icon ui-icon-minus"></span></td><td><span class="lfloat ui-icon ui-icon-minus"></span></td><td><span class="lfloat ui-icon ui-icon-minus"></span></td><td><span class="lfloat ui-icon ui-icon-minus"></span></td><td><span class="lfloat ui-icon ui-icon-minus"></span></td><td><span class="lfloat ui-icon ui-icon-minus"></span></td><td><span class="lfloat ui-icon ui-icon-minus"></span></td></tr>').appendTo("#load_list_metas tbody")}}})},_addNewMetas:function(){$("#forms-config-rewrite").submit(function(){$(this).ajaxSubmit({url:"/admin/rewritemetas.php?add=1",type:"post",resetForm:true,beforeSubmit:function(){$("#result-search-page").html('<img class="loader-block" src="/framework/img/square-circle.gif" />')},success:function(a){$.notice({ntype:"simple",time:2});$(".mc-head-request").html(a);ns_jrewritemetas._listingRecords()}});return false})},_updateMetas:function(){$("#forms-config-rewrite-update").submit(function(){var a=$("#idrewrite").val();if(a!=null){$(this).ajaxSubmit({url:"/admin/rewritemetas.php?edit="+a+"&post",type:"post",resetForm:false,beforeSubmit:function(){$("#result-search-page").html('<img class="loader-block" src="/framework/img/square-circle.gif" />')},success:function(b){$.notice({ntype:"simple",time:2});$(".mc-head-request").html(b);ns_jrewritemetas._listingRecords()}});return false}else{console.log("%s: %o","rewriteid is null",a)}})},_deleteMetas:function(){$(".d-config-rmetas").live("click",function(b){b.preventDefault();var a=$(this).attr("title");$("#dialog").dialog({bgiframe:true,resizable:false,height:140,modal:true,title:"Supprimé cette réécriture ?",buttons:{"Delete item":function(){$(this).dialog("close");$.ajax({type:"post",url:"/admin/rewritemetas.php",data:"drmetas="+a,statusCode:{0:function(){console.error("jQuery Error")},401:function(){console.warn("access denied")},404:function(){console.warn("object not found")},403:function(){console.warn("request forbidden")},408:function(){console.warn("server timed out waiting for request")},500:function(){console.error("Internal Server Error")}},async:false,success:function(){ns_jrewritemetas._listingRecords()}})},Cancel:function(){$(this).dialog("close")}}})})}};